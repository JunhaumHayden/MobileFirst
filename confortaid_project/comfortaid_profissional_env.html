<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ComfortAid √Årea Restrita</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <!-- ... -->
    <link rel="shortcut icon" type="imagex/png" href="/PHP/assets/icon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,300;1,200;1,400&family=Red+Hat+Display:wght@400;500;700&family=Roboto&display=swap"
    rel="stylesheet">
    <!-- ... -->
    <link rel='stylesheet' type='text/css' media='screen' href='./assets/css/style.css'>
    <!-- font-awesome -->
    <link rel='stylesheet' type='text/css' media='screen'         
            href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css'>
     <!-- Bootstrap CSS -->
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        /* body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
        } */
        .container_inner {
            display: flex;
            justify-content: space-evenly; /* Distribui o espa√ßo entre os filho de maneira igual*/
            flex-wrap: wrap; /* Permite que o flex defina o n√∫mero de elementos por linha*/
            gap: 6rem; /* Define o espa√ßo entre os elementos filhos*/
            padding: 1rem;

            margin-bottom: 15rem;
            background-color: #f5f5f5;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            margin: 10rem;
            
            /* width: 100%;
            max-width: 400px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); 
            border-radius: 8px; 
            flex-direction: column;
            align-items: center;
            height: 100vh; */
        }
        .hidden {
            display: none;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
        }
        .form-group input {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
        }
        .form-group button {
            width: 100%;
            padding: 10px;
            background-color: #007BFF;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .form-group button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    
    <header>
        <h1>üåê ComfortAid üêò</h1>
    </header>
     <!-- barra de navegacao da Aplica√ß√£o -->
     <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <!-- Bot√£o do menu de hamb√∫rguer -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
    
            <!-- Itens do menu -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="indexx.html">In√≠cio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="navega('home')">Voltar</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="tel:+5548988900001">Contato</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container_inner">
        <!-- Apresentacao de login -->
        <div id="login-page">
            <h2 class="text-center">Login</h2>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="password">Senha</label>
                <input type="password" id="password" class="form-control" required>
            </div>
            <div class="form-group">
                <button class="btn btn-primary" onclick="login()">Entrar</button>
            </div>
        </div>
        <!-- Apresentacao da area restrita a profissionais -->
        <div id="professional-page" class="hidden">
             <!-- Bot√£o para alternar a visibilidade -->
            <!-- Menu de Navega√ß√£o -->
            <nav class="navbar navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#userNav" aria-controls="userNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="userNav">
                        <div class="navigation d-flex justify-content-around mb-4">
                            <button type="button" class="btn btn-primary" onclick="navega('home')">
                                <i class="fa-solid fa-home"></i> Home
                            </button>
                            <button type="button" class="btn btn-primary" onclick="navega('update-data')">
                                <i class="fa-solid fa-concierge-bell"></i> Atualizar Dados
                            </button>
                            <button type="button" class="btn btn-primary" onclick="navega('new-service')">
                                <i class="fa-solid fa-file"></i> Cadastrar Novo Servi√ßo
                            </button>
                            <button type="button" class="btn btn-primary" onclick="navega('Reviews')">
                                <i class="fa-solid fa-star"></i> Avalia√ß√µes
                            </button>
                            <button type="button" class="btn btn-primary" onclick="logout()">
                                <i class="fa-solid fa-right-from-bracket"></i> Sair
                            </button>
                        </div>
                    </div>
                </div>
            </nav>
             <!-- Elemento que ser√° alternado -->
             <!-- Apresentacao Elemento Home -->
            <div id="home" class="tela show">
                <h3>HOME</h3>
                <h2>Bem-vindo, <span id="professional-name"></span></h2>
                <button class="btn btn-secondary" onclick="navega('update-data')">Atualizar Dados</button>
                <button class="btn btn-secondary" onclick="navega('new-service')">Cadastrar Novo Servi√ßo</button>
                
                <h4>Agendamentos Programados</h4>
                    <div class="row" id="scheduled-appointments"></div>
                    <div id="error-message" class="error-message"></div>
                    <ul id="appointments-list"></ul>
                    <!-- Conte√∫do da p√°gina de apresenta√ß√£o -->
            </div>
            <!-- Apresentacao Elemento Atualizar Dados -->
            <div id="update-data" class="tela collapse">
                <h3>Atualizar Dados</h3>
                <!-- Formul√°rio para atualizar dados -->
            </div>
            <!-- Apresentacao Elemento Aadastrar Novo Servi√ßo -->
            <div id="new-service" class="tela collapse">
                <h3>Cadastrar Novo Servi√ßo</h3>
                <!-- Formul√°rio para cadastrar novo servi√ßo -->
            </div>
             <!-- Apresentacao de Avaliacoes e parceiros do aplicativo-->
            <div id="Reviews" class="tela collapse">
                <div class="container">
                    <div class="row">
                        <div class="col-md-8">
                        <h3>Avalia√ß√µes</h3>
                        <div id="reviews-list" class="list-group">
                            <!-- Avalia√ß√µes ser√£o carregadas aqui -->
                        </div>
                        </div>
                        <div class="col-md-4">
                        <h4>Links Patrocinados</h4>
                        <div class="list-group">
                            <a href="https://junhaumhayden.github.io/publish/" class="list-group-item list-group-item-action">Landingpage</a>
                            <a href="https://junhaumhayden.github.io/publish/flexturismo.html" class="list-group-item list-group-item-action">FlexTurismo</a>
                            <a href="https://junhaumhayden.github.io/publish/gatinhos.html" class="list-group-item list-group-item-action">Ver Gatinhos Fofinhos</a>
                            <a href="https://arthurs08.github.io/ChefListPrj/" class="list-group-item list-group-item-action">ChefList</a>
                        </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Apresentacao da area restrita a cliente -->
        <div id="cliente-page" class="hidden">
          <!-- Bot√£o para alternar a visibilidade -->
            <!-- Menu de Navega√ß√£o -->
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#userNav" aria-controls="userNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="userNav">
                    <div class="navigation d-flex justify-content-around mb-4">
                        <button type="button" class="btn btn-primary" onclick="navega('home')">
                            <i class="fa-solid fa-home"></i> Home
                        </button>
                        <button type="button" class="btn btn-primary" onclick="navega('update-data')">
                            <i class="fa-solid fa-concierge-bell"></i> Atualizar Dados
                        </button>
                        <!-- <button type="button" class="btn btn-primary" onclick="navega('new-service')">
                            <i class="fa-solid fa-file"></i> Cadastrar Novo Servi√ßo
                        </button> -->
                        <button type="button" class="btn btn-primary" onclick="navega('Reviews')">
                            <i class="fa-solid fa-star"></i> Avalia√ß√µes
                        </button>
                        <button type="button" class="btn btn-primary" onclick="logout()">
                            <i class="fa-solid fa-right-from-bracket"></i> Sair
                        </button>
                    </div>
                </div>
            </div>
        </nav>
            <!-- Elemento que ser√° alternado -->
            <!-- Apresentacao Elemento Home -->
            <div id="home" class="tela show">
                <h3>HOME</h3>
                <h2>Bem-vindo, <span id="cliente-name"></span></h2>
                <button class="btn btn-secondary" onclick="navega('update-data')">Atualizar Dados</button>
                <!-- <button class="btn btn-secondary" onclick="navega('new-service')">Consultar Agendamentos</button> -->
                
                <h4>Agendamentos Programados</h4>
                    <div class="row" id="scheduled-appointments"></div>
                    <div id="error-message" class="error-message"></div>
                    <ul id="appointments-list"></ul>
                    <!-- Conte√∫do da p√°gina de apresenta√ß√£o -->
            </div>
            <!-- Apresentacao Elemento Atualizar Dados -->
            <div id="update-data" class="tela collapse">
                <h3>Atualizar Dados</h3>
                <!-- Formul√°rio para atualizar dados -->
            </div>
            
            <!-- Apresentacao de Avaliacoes e parceiros do aplicativo-->
            <div id="Reviews" class="tela collapse">
                <div class="container">
                    <div class="row">
                        <div class="col-md-8">
                        <h3>Avalia√ß√µes</h3>
                        <div id="reviews-list" class="list-group">
                            <!-- Avalia√ß√µes ser√£o carregadas aqui -->
                        </div>
                        </div>
                        <div class="col-md-4">
                        <h4>Links Patrocinados</h4>
                        <div class="list-group">
                            <div class="ad">
                                <a href="https://junhaumhayden.github.io/publish/" class="list-group-item list-group-item-action">Landingpage</a>
                            </div>
                            <div class="ad">
                                <figure>
                                    <img src="../FrontEnd/landingpage/Flexbox/anuncios/imagens/icon-1.png" width="100" alt="FlexTurismo">
                                </figure>
                                <a href="https://junhaumhayden.github.io/publish/flexturismo.html" class="list-group-item list-group-item-action">FlexTurismo</a>
                            </div>
                            <div class="ad">
                                <img src="https://img.freepik.com/vetores-gratis/gato-bonito-com-ilustracao-dos-desenhos-animados-do-amor-sinal-mao-conceito-de-natureza-animal-isolado-estilo-flat-cartoon_138676-3419.jpg?w=1480&t=st=1724200872~exp=1724201472~hmac=de3b4f39c0ead5885aecdb0ddfe10c41815b69e81d8b9a53a390d50bd5533998" width= 100 alt="Amazon">
                                <p><a href="../FrontEnd/landingpage/Flexbox/anuncios/gatinhos.html">Veja os Gatinhos mais fofinhos com JavaScript</a></p>
                            
                                <a href="https://junhaumhayden.github.io/publish/gatinhos.html" class="list-group-item list-group-item-action">Ver Gatinhos Fofinhos</a>
                            </div>
                            <div class="ad">
                                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQtLRjfzWzhL9UimIixsWB-DKOeRub2CFgC29qHsR7PXxF-Inptit722udqVMesTLsYbJl6Fw&s" width= 100 alt="ChefList, as melhores receitas da internet">
                                <a href="https://arthurs08.github.io/ChefListPrj/" class="list-group-item list-group-item-action">ChefList</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer>
        <div class="footer-container">
            <div class="logo">
                <img src="/PHP/assets/icons/icon36x36.ico" width="30" alt="Logo">
            </div>
            <div class="info">
                <div>&copy; 2024 HTML / CSS / JavaScript / BootStrap</div>
                <div>Desenvolvido por: Carlos Hayden Junior</div>
            </div>
            <div class="icons">
                <img src="/PHP/assets/icons/icon-html5-48.png" width="20" alt="HTML Icon">
                <img src="/PHP/assets/icons/icon-css3-48.ico" width="20" alt="CSS Icon">
                <img src="/PHP/assets/icons/icons8-js-48.png" width="20" alt="JS Icon">
            </div>
        </div>
        
    </footer>
     <!-- Bootstrap JS (opcional, necess√°rio para funcionalidades como o menu de hamb√∫rguer) -->
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
    // Fun√ß√µes de autentica√ß√£o e sess√£o    
        // Verifica se h√° um usu√°rio logado ao carregar a p√°gina
        document.addEventListener("DOMContentLoaded", function () {
            const user = getSession();
            if (user) {
                redirectToDashboard(user);
            }
        });
        // Salva usu√°rio na sess√£o
        function saveSession(user) {
            sessionStorage.setItem('user', JSON.stringify(user));
        }

        // Recupera usu√°rio da sess√£o
        function getSession() {
            return JSON.parse(sessionStorage.getItem('user'));
        }

        // Apaga a sess√£o (logout)
        function logout() {
            sessionStorage.clear();
             // Redireciona para a p√°gina de login
            document.getElementById('professional-page').classList.add('hidden');
            document.getElementById('cliente-page').classList.add('hidden');
            document.getElementById('login-page').classList.remove('hidden');
            window.location.href = "indexx.html";
        }

        // Autentica√ß√£o e redirecionamento
        async function authenticate(email, password) {
            try {
                const response = await axios.post('http://localhost:5000/api/usuarios/login', { email, senha: password });
                const user = response.data;
                if (user) {
                    saveSession(user);
                    redirectToDashboard(user);
                } else {
                    alert('Email ou senha incorretos');
                }
            } catch (error) {
                console.error('Erro ao autenticar:', error);
                alert('Erro ao autenticar. Tente novamente mais tarde.');
            }
        }

        // Redireciona usu√°rio para a √°rea correta
        function redirectToDashboard(user) {
            if (user.tipo === "profissional") {
                // window.location.href = "dashboard-profissional.html";
                document.getElementById('login-page').classList.add('hidden');
                document.getElementById('professional-page').classList.remove('hidden');
                document.getElementById('professional-name').textContent = user.nome;
                fetchAppointmentsProfessional(user.id)
            } else if (user.tipo === "cliente") {
                // window.location.href = "dashboard-cliente.html";
                document.getElementById('login-page').classList.add('hidden');
                document.getElementById('cliente-page').classList.remove('hidden');
                document.getElementById('cliente-name').textContent = user.nome;
                fetchAppointmentsClient(user.id)
            } else {
                alert("Tipo de usu√°rio inv√°lido");
                logout();
            }
        }
        // Fun√ß√£o para realizar o login
        function login() {
            // Captura o valor do campo de email
            const email = document.getElementById('email').value;
            // Captura o valor do campo de senha
            const password = document.getElementById('password').value;
            // Chama a fun√ß√£o authenticate passando o email e a senha
            authenticate(email, password);
        }
    // Fun√ß√£o para carregar conte√∫do dinamicamente
        async function loadContent(url, containerId) {
            try {
                const response = await fetch(url);
                const content = await response.text();
                document.getElementById(containerId).innerHTML = content;
                attachFormListeners(); // Anexar listeners aos formul√°rios carregados
            } catch (error) {
                console.error('Erro ao carregar o conte√∫do:', error);
            }
        }

        // Fun√ß√£o para anexar listeners aos formul√°rios
        function attachFormListeners() {
            const updateDataForm = document.getElementById('update-data-form');
            if (updateDataForm) {
                updateDataForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const formData = new FormData(updateDataForm);
                    const data = Object.fromEntries(formData.entries());
                    console.log('Dados atualizados:', data);
                    // Enviar dados para a API
                    alert('Submit pressionado!!');
                });
            }

            const newServiceForm = document.getElementById('new-service-form');
            if (newServiceForm) {
                newServiceForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const formData = new FormData(newServiceForm);
                    const data = Object.fromEntries(formData.entries());
                    console.log('Novo servi√ßo:', data);
                    // Enviar dados para a API
                    alert('Submit pressionado!!');
                });
            }
        }

    // Fun√ß√µes de navega√ß√£o
        function navega(destino) {
            let telas = document.getElementsByClassName('tela');
            Array.from(telas).forEach(element => {
                element.classList.remove('show');
                element.classList.add('collapse');
            });
            const targetElement = document.getElementById(destino);
            targetElement.classList.remove('collapse');
            targetElement.classList.add('show');

            // Carregar conte√∫do din√¢mico
            if (destino === 'update-data') {
                loadContent('./assets/forms/update-data.html', 'update-data');
            } else if (destino === 'new-service') {
                loadContent('./assets/forms/new-service.html', 'new-service');
            }
        }
    // Fun√ß√µes de carregamento de dados
 
// Funcao para apresentar a agenda de profissional
        async function fetchAppointmentsProfessional(professionalId) {
            try {
                // Recupera os agendamentos do profissional
                const response = await axios.get(`http://localhost:5000/agendamentos/profissional/${professionalId}`);
                const appointments = response.data;

                // Limpa a lista de agendamentos
                const appointmentsList = document.getElementById('scheduled-appointments');
                appointmentsList.innerHTML = '';

                // Filtros de status
                const statusFilters = {
                    CONFIRMADO: [],
                    CANCELADO: [],
                    PENDENTE: []
                };

                // Organiza os agendamentos por status
                appointments.forEach(appointment => {
                    statusFilters[appointment.status].push(appointment);
                });

                // Cria cards para cada status
                for (const [status, filteredAppointments] of Object.entries(statusFilters)) {
                    if (filteredAppointments.length > 0) {
                        // Cria um container para os agendamentos do status atual
                        const statusContainer = document.createElement('div');
                        statusContainer.classList.add('mb-4');
                        statusContainer.innerHTML = `<h5 class="mb-3">${status}</h5>`;
                        appointmentsList.appendChild(statusContainer);

                        // Cria cards para cada agendamento
                        filteredAppointments.forEach(appointment => {
                            const card = document.createElement('div');
                            card.classList.add('col-md-4', 'mb-3');
                            card.innerHTML = `
                                <div class="card">
                                    <div class="card-body">
                                        <div class="d-flex align-items-center mb-3">
                                            <img src="http://localhost:5000/imagens/usuario/foto/${appointment.cliente.id}" 
                                                alt="${appointment.cliente.nome}" 
                                                class="rounded-circle me-3" 
                                                width="50" 
                                                height="50">
                                            <h6 class="card-title mb-0">${appointment.servico.nome}</h6>
                                        </div>
                                        <p class="card-text">
                                            <strong>Cliente:</strong> ${appointment.cliente.nome}<br>
                                            <strong>Data:</strong> ${new Date(appointment.dataHora).toLocaleString()}
                                        </p>
                                        <button class="btn btn-primary btn-sm" onclick="showAppointmentDetails(${appointment.id})">
                                            Ver Detalhes
                                        </button>
                                    </div>
                                </div>
                            `;
                            statusContainer.appendChild(card);
                        });
                    }
                }
            } catch (error) {
                console.error('Erro ao buscar agendamentos:', error);
                document.getElementById('error-message').innerHTML = `
                    <div class="alert alert-danger" role="alert">
                        Erro ao carregar agendamentos. Tente novamente mais tarde.
                    </div>
                `;
            }
        }

        // Fun√ß√£o para exibir detalhes do agendamento
        async function showAppointmentDetails(appointmentId) {
            try {
                // Recupera os detalhes do agendamento
                const response = await axios.get(`http://localhost:5000/agendamentos/${appointmentId}`);
                const appointment = response.data;

                // Recupera o endere√ßo do cliente usando o CEP
                const cepResponse = await axios.get(`https://viacep.com.br/ws/${appointment.cliente.cep}/json/`);
                const endereco = cepResponse.data;

                // Exibe os detalhes em um modal
                const modalContent = `
                    <div class="modal fade" id="appointmentDetailsModal" tabindex="-1" aria-labelledby="appointmentDetailsModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-lg">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="appointmentDetailsModalLabel">Detalhes do Agendamento</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6>Servi√ßo</h6>
                                            <p><strong>Nome:</strong> ${appointment.servico.nome}</p>
                                            <p><strong>Descri√ß√£o:</strong> ${appointment.servico.descricao}</p>
                                            <p><strong>Pre√ßo:</strong> R$${appointment.servico.preco}</p>
                                            <p><strong>Dura√ß√£o:</strong> ${appointment.servico.duracao} minutos</p>
                                        </div>
                                        <div class="col-md-6">
                                            <h6>Cliente</h6>
                                            <p><strong>Nome:</strong> ${appointment.cliente.nome}</p>
                                            <p><strong>Nome:</strong> ${appointment.cliente.nascimento}</p>
                                            <p><strong>Telefone:</strong> ${appointment.cliente.telefone}</p>
                                            <p><strong>Endere√ßo:</strong> ${endereco.logradouro}, ${appointment.cliente.numeroEndereco}, ${endereco.bairro}, ${endereco.localidade} - ${endereco.uf} - ${appointment.cliente.cep}</p>
                                            <p><strong>Complemento:</strong> ${appointment.cliente.complementoEndereco}</p>
                                        </div>
                                    </div>
                                    <div class="mt-3">
                                        <h6>Mapa</h6>
                                        <iframe 
                                            width="100%" 
                                            height="300" 
                                            style="border:0" 
                                            loading="lazy" 
                                            allowfullscreen 
                                            src="https://www.google.com/maps/embed/v1/place?key=SUA_CHAVE_API&q=${endereco.logradouro},${endereco.bairro},${endereco.localidade}">
                                        </iframe>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                                    <button type="button" class="btn btn-primary" onclick="updateAppointmentStatus(${appointment.id}, 'CONFIRMADO')">Confirmar</button>
                                    <button type="button" class="btn btn-warning" onclick="updateAppointmentStatus(${appointment.id}, 'PENDENTE')">Pendente</button>
                                    <button type="button" class="btn btn-danger" onclick="updateAppointmentStatus(${appointment.id}, 'CANCELADO')">Cancelar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                // Adiciona o modal ao DOM e exibe
                document.body.insertAdjacentHTML('beforeend', modalContent);
                const modal = new bootstrap.Modal(document.getElementById('appointmentDetailsModal'));
                modal.show();
            } catch (error) {
                console.error('Erro ao buscar detalhes do agendamento:', error);
                alert('Erro ao carregar detalhes do agendamento. Tente novamente mais tarde.');
            }
        }

        // Fun√ß√£o para atualizar o status do agendamento
        async function updateAppointmentStatus(appointmentId, status) {
            try {
                const response = await axios.put(`http://localhost:5000/agendamentos/status/${appointmentId}`, {
                    status: status},
                {
                headers: {
                    "Content-Type": "application/json",
                    "Accept": "application/json"
                }
            });

                if (response.status === 200) {
                    alert('Status do agendamento atualizado com sucesso!');
                    fetchAppointmentsProfessional(getSession().id); // Atualiza a lista de agendamentos
                }
            } catch (error) {
                console.error('Erro ao atualizar status do agendamento:', error);
                alert('Erro ao atualizar status. Tente novamente mais tarde.');
            }
        }
    // Funcao para apresentar a agenda de cliente
        async function fetchAppointmentsClient(clienteId) {
            try {
                const response = await fetch(`http://localhost:5000/agendamenClient{clienteId}`);
                const appointments = await response.json();
                const appointmentsList = document.getElementById('appointments-list');
                appointmentsList.innerHTML = '';

                appointments.forEach(appointment => {
                    const listItem = document.createElement('li');
                    listItem.classList.add('appointment-card');
                    listItem.innerHTML = `
                        <h4>${appointment.servico.nome}</h4>
                        <p>Cliente: ${appointment.cliente.nome}</p>
                        <p>Data: ${new Date(appointment.dataHora).toLocaleString()}</p>
                    `;
                    listItem.onclick = () => showAppointmentDetails(appointment);
                    appointmentsList.appendChild(listItem);
                });
            } catch (error) {
                console.error('Erro ao buscar agendamentos:', error);
                alert('Erro ao buscar agendamentos. Tente novamente mais tarde.');
            }

            // A funcao deve gerar um card para cada agendamento da lista retornada pela API com as informa√ßoes do nome do servico, nome do Profissional e data
            // Deve haver filtro por status do agendamento ("CONFIRMADO", "CANCELADO", "PENDENTE")

            // Ao clicar no card de agendamento deve abrir um novo card com os detalhes do agendamento, deve conter os detalhes do servi√ßo e informa√ßoes de contato do profissional
            // Deve haver botoes para alterar facilmente status do agendamento para "CANCELADO".

            // const apiAtualizarAgendamentoClientePorIdUrl = `http://localhost:5000/agendamentos/status/${clienteId}`
            
            // Exemplo de envio no corpo: 
            // {
            //     "cliente": {
            //         "id": 1
            //     },
            //     "servico": {
            //         "id": 1
            //     },
            //     "dataHora": "2024-02-17T10:00:00",
            //     "status": "CONFIRMADO"
            // }
            
            // // const apiBuscarAgendamentosClientePorIdUrl = '`http://localhost:5000/agendamentos/cliente/${clienteId}`';

            // exemplo de retorno da API: 
            // [
            //     {
            //         "id": 1,
            //         "cliente": {
            //             "id": 1,
            //             "nome": "Ana Amalia",
            //             "email": "ana@mail.com",
            //             "senha": "senha",
            //             "telefone": "(11) 99999-0001",
            //             "cep": "88111-111",
            //             "complementoEndereco": "Apto 101",
            //             "numeroEndereco": "001",
            //             "tipo": "cliente",
            //             "cpf": "11111111111",
            //             "nascimento": "1955-01-12"
            //         },
            //         "servico": {
            //             "id": 1,
            //             "nome": "Massagem Relaxante",
            //             "descricao": "Sess√£o de massagem para aliviar o estresse e tens√µes",
            //             "preco": 120.0,
            //             "duracao": 60,
            //             "situacao": "ATIVO",
            //             "dataDisponivel": "2025-01-12",
            //             "profissional": {
            //                 "id": 3,
            //                 "nome": "Dany Damaris",
            //                 "email": "dany@mail.com",
            //                 "senha": "senha",
            //                 "telefone": "(31) 97777-0003",
            //                 "cep": "88333-333",
            //                 "complementoEndereco": "Sala 3",
            //                 "numeroEndereco": "003",
            //                 "tipo": "profissional",
            //                 "especialidade": "Massoterapia",
            //                 "registroProfissional": "REG33333"
            //             }
            //         },
            //         "dataHora": "2024-01-12T10:00:00",
            //         "status": "CONFIRMADO"
            //     }
            // ]
        }

        // Fun√ß√£o para atualizar os dados
        function carregarAtualizarDados(){
            // Funcao para gerar um card para atualizar os dados do usuario.
            // Deve carregar conforme o tipo de usuario autenticado.
            // Deve fornecer os campos preenchidos com os dados atuais e o usuario altera o que julgar necessario: 
            // Profissional:
            // const apiBuscarProfissionalPorIdUrl = 'http://localhost:5000/api/usuarios/${profissionalId}';
            // exemplo de retorno: 
            // {
            //     "id": 3,
            //     "nome": "Dany Damaris",
            //     "email": "dany@mail.com",
            //     "senha": "senha",
            //     "telefone": "(31) 97777-0003",
            //     "cep": "88333-333",
            //     "complementoEndereco": "Sala 3",
            //     "numeroEndereco": "003",
            //     "tipo": "profissional",
            //     "especialidade": "Massoterapia",
            //     "registroProfissional": "REG33333"
            // }
            // const apiAtualizarProfissionalUrl = 'http://localhost:5000/profissionais/${profissionalId}';
            // Exemplo de envio: 
            // {
            //     "nome": "Clara Clarinetes",
            //     "email": "claras@mail.com",
            //     "senha": "senha2222",
            //     "telefone": "(48) 98888-2022",
            //     "cep": "88020-002",
            //     "numeroEndereco": "002",
            //     "complementoEndereco": "Sala02",
            //     "especialidade": "Fitoterapias Qu√¢ntica",
            //     "registroProfissional": "REG00002"
            // }

            // Cliente:
            // const apiBuscarClientePorIdUrl = 'http://localhost:5000/api/usuarios/${clienteId}';
            // exemplo de retorno:
            // {
            //     "id": 1,
            //     "nome": "Ana Amalia",
            //     "email": "ana@mail.com",
            //     "senha": "senha",
            //     "telefone": "(11) 99999-0001",
            //     "cep": "88111-111",
            //     "complementoEndereco": "Apto 101",
            //     "numeroEndereco": "001",
            //     "tipo": "cliente",
            //     "cpf": "11111111111",
            //     "nascimento": "1955-01-12"
            // }
            // const apiAtualizarClienteUrl = 'http://localhost:5000/clientes/${clienteId}';
            // Exemplo de envio: 
            // {
            //     "nome": "Clara Clarinete",
            //     "email": "clara@mail.com",
            //     "senha": "senha22",
            //     "telefone": "(48) 98888-2222",
            //     "cep": "88020-222",
            //     "numeroEndereco": "222",
            //     "complementoEndereco": "Sala22",
            //     "tipo": "cliente",
            //     "cpf": "11111111111",
            //     "nascimento": "2000-02-12"
            // }

            
        }

        // Fun√ß√£o para cadastrar um novo servico
        function cadastrarNovoServico(){
            // Fun√ßao para gerar um card para criar um novo servico.
            // const apiCriarServicoUrl = 'http://localhost:5000/servicos';
            // Id Profissicional deve ser recuperado da sessao. 

            // exemplo de envio no corpo:
            // {
            //     "nome": "Servico de teste",
            //     "descricao": "Acompanhamento dos primeiros teste de criar servico.",
            //     "preco": 300.0,
            //     "duracao": 180,
            //     "situacao": "ATIVO",
            //     "dataDisponivel": "2024-02-22",
            //     "profissional": {
            //         "id": 4
            //     }
            // }

            // deve haver um campo para envio de imagem relacionada ao servico

            // const apiEnviarImagemServicoUrl = 'http://localhost:5000/imagens/servico/${servicoId}'

        }

        // Fun√ß√£o para carregar as avalia√ß√µes
        function carregarAvaliacoes() {
            const apiAvaliacoesUrl = 'http://localhost:5000/avaliacoes';
            axios.get(apiAvaliacoesUrl)
                .then(response => {
                const reviewsList = document.getElementById('reviews-list');
                reviewsList.innerHTML = ''; // Limpa a lista antes de adicionar novos itens
                response.data.forEach(avaliacao => {
                    const reviewItem = document.createElement('div');
                    reviewItem.className = 'list-group-item';

                    const reviewContent = `
                    <h5 class="mb-1">${avaliacao.cliente.nome}</h5>
                    <p class="mb-1">${avaliacao.comentario}</p>
                    <small>Nota: ${avaliacao.nota} - Servi√ßo: ${avaliacao.servico.nome}</small>
                    `;

                    reviewItem.innerHTML = reviewContent;
                    reviewsList.appendChild(reviewItem);
                });
                })
                .catch(error => {
                console.error('Erro ao carregar as avalia√ß√µes:', error);
                document.getElementById('reviews-list').innerHTML = 'Ocorreu um erro ao carregar as avalia√ß√µes. Tente novamente mais tarde.';
                });
            }

       // Event listeners
       document.addEventListener('DOMContentLoaded', () => {
            const user = getSession();
            if (user) {
                redirectToDashboard(user);
            }
        });

        document.querySelector('button[onclick="navega(\'update-data\')"]').addEventListener('click', () => navega('update-data'));
        document.querySelector('button[onclick="navega(\'new-service\')"]').addEventListener('click', () => navega('new-service'));
        document.querySelector('button[onclick="navega(\'Reviews\')"]').addEventListener('click', carregarAvaliacoes);

    //     document.querySelector('button[onclick="navega(\'update-data\')"]').addEventListener('click', carregarAtualizarDados);
    //     document.querySelector('button[onclick="navega(\'new-service\')"]').addEventListener('click', cadastrarNovoServico);
    //     document.querySelector('button[onclick="navega(\'Reviews\')"]').addEventListener('click', carregarAvaliacoes);
    // </script>
</body>
</html>